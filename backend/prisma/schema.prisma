// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id          String        @id @default(uuid()) @db.VarChar(50)
  nome        String        @unique
  email       String        @unique
  senha       String
  ativo       Boolean?
  posts       Postagem[]
  listas      ListaJogo[]
  curtidas    CurtidaPost[]
  seguindo    Seguidor[]    @relation("Seguindo")
  seguidores  Seguidor[]    @relation("Seguidores")
  naoAtivoDesde DateTime?
  criadoEm    DateTime      @default(now())
  atualizadoEm DateTime     @updatedAt

  @@index([nome])
}

model Seguidor {
  id          String   @id @default(uuid()) @db.VarChar(50)
  seguidorId  String
  seguindoId  String

  seguidor    Usuario  @relation("Seguindo", fields: [seguidorId], references: [id])
  seguindo    Usuario  @relation("Seguidores", fields: [seguindoId], references: [id])

  @@unique([seguidorId, seguindoId])
}

model Postagem {
  id          String         @id @default(uuid()) @db.VarChar(50)
  conteudo    String
  usuario     Usuario        @relation(fields: [usuarioId], references: [id])
  usuarioId   String
  criadoEm    DateTime       @default(now())
  atualizadoEm DateTime      @updatedAt
  jogos       PostagemJogo[]
  curtidas    CurtidaPost[]  
}

model CurtidaPost {
  id          String      @id @default(uuid()) @db.VarChar(50)
  usuario     Usuario     @relation(fields: [usuarioId], references: [id])
  usuarioId   String
  postagem    Postagem    @relation(fields: [postagemId], references: [id])
  postagemId  String

  @@unique([usuarioId, postagemId])
}

model Jogo {
  id            String           @id @default(uuid()) @db.VarChar(50)
  nome          String
  steamId       Int              @unique
  caminhoImagem String
  postagens     PostagemJogo[]
  listas        ListaJogoJogo[]
  criadoEm      DateTime         @default(now())
  atualizadoEm  DateTime         @updatedAt
  @@index([nome])
}

model ListaJogo {
  id          String         @id @default(uuid()) @db.VarChar(50)
  nome        String
  usuario     Usuario        @relation(fields: [usuarioId], references: [id])
  usuarioId   String
  jogos       ListaJogoJogo[]
  criadoEm    DateTime       @default(now())
  atualizadoEm DateTime      @updatedAt
}

model PostagemJogo {
  id          String      @id @default(uuid()) @db.VarChar(50)
  postagem    Postagem    @relation(fields: [postagemId], references: [id])
  postagemId  String
  jogo        Jogo        @relation(fields: [jogoId], references: [id])
  jogoId      String

  @@unique([postagemId, jogoId])
}

model ListaJogoJogo {
  id           String      @id @default(uuid()) @db.VarChar(50)
  listaJogo    ListaJogo   @relation(fields: [listaJogoId], references: [id])
  listaJogoId  String
  jogo         Jogo        @relation(fields: [jogoId], references: [id])
  jogoId       String

  @@unique([listaJogoId, jogoId])
}

model Admin {
  id String @id @default(uuid()) @db.VarChar(50)
  email String @unique
  senha String
  criadoEm DateTime @default(now())
}
